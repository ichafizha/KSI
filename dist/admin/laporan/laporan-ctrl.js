function statistik(){return{restrict:"E",template:'<canvas id="bar" class="chart chart-bar" chart-data="laporanStatistik.data" chart-labels="laporanStatistik.labels"></canvas>'}}function LaporanInputCtrl(a,t,e,i,n,r){function o(a){u.dataJenis=a.data.response}function d(a){u.dataLokasi=a.data.response}function s(a){var t=new FileReader;t.onload=function(a){var t=new Image;return t.onload=function(){width=t.width,height=t.height,width>height?width>MAX_SIZE&&(height*=MAX_SIZE/width,width=MAX_SIZE):height>MAX_SIZE&&(width*=MAX_SIZE/height,height=MAX_SIZE),h.canvas.width=width,h.canvas.height=height,h.drawImage(t,0,0,width,height)},t.src=a.target.result,images=t,t},t.readAsDataURL(a.target.files[0])}function l(e){function i(t){r.Sukses(),a.go("admin.laporankejahatan-view")}var o={alamat:e.alamat,deskripsi:e.deskripsi,idJenis:e.idJenis,idLokasi:e.idLokasi,imgURL:e.imgURL,judul:e.judul,latitude:e.latitude,longitude:e.longitude,tanggalKejadian:e.tanggalKejadian,waktuKejadian:e.waktuKejadian},d=document.querySelector("canvas"),s=d.toDataURL("image/png");o.idRole=3,o.idJenis=Number(o.idJenis),o.idLokasi=Number(o.idLokasi),o.idStatus=1,o.idPetugas=1,o.latitude=Number(o.latitude),o.longitude=Number(o.longitude),o.imgURL=s,o.tanggalKejadian=n("date")(u.tanggalKejadian,"dd-MM-yyyy"),o.waktuKejadian=n("date")(u.waktuKejadian,"HH:mm"),void 0===e||t.postDataLaporan(o).success(i).error(function(a,t){400===t&&r.Gagal()})}var u=this;e.getAllData().then(o),i.getAllData().then(d);MAX_SIZE=200;var u=this,c=document.getElementById("canvas"),h=c.getContext("2d"),g=document.getElementById("gambarKejahatan");g.addEventListener("change",s),u.tambah=l}function LaporanViewCtrl(a,t,e,i,n){function r(a){document.querySelector("loading").style.visibility="hidden",c.dataLokasi=a.data.response}function o(a){document.querySelector("loading").style.visibility="hidden",c.dataJenis=a.data.response}function d(a){document.querySelector("loading").style.visibility="hidden",c.dataStatus=a.data.response}function s(a){c.data=a.data.response}function l(t,e,i){function r(){a.deleteLaporan(t).then(function(){c.dataLaporan=a.getAllData().then(s)})}n.Hapus(r,e)}function u(a){i.go("admin.laporankejahatan-update",{id:a})}var c=this;t.getAllData().then(r),e.getAllData().then(o);c.getStatus=a.getAllStatus().then(d),c.dataLaporan=a.getAllData().then(s),c["delete"]=l,c.update=u}function LaporanStatistikCtrl(a){function t(a){var t=a.data.response,i=[],a=[];t.forEach(function(t){i.push(t.label),a.push(t.jumlah)}),e.labels=i,e.data=[a]}var e=this;a.getStatistik().then(t)}angular.module("CrimeZone").controller("LaporanInputCtrl",LaporanInputCtrl).controller("LaporanViewCtrl",LaporanViewCtrl).controller("LaporanStatistikCtrl",LaporanStatistikCtrl).directive("statistik",statistik),LaporanInputCtrl.$inject=["$state","LaporanService","JenisService","LokasiService","$filter","ActionService"],LaporanViewCtrl.$inject=["LaporanService","LokasiService","JenisService","$state","ActionService"],LaporanStatistikCtrl.$inject=["LaporanService"];